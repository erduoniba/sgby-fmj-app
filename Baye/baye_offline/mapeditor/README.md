# 三国霸业地图编辑器使用说明

## 简介

三国霸业地图编辑器是一个基于Web的可视化地图编辑工具，专门为三国霸业游戏设计。用户可以通过浏览器直接创建、编辑和导出自定义地图，无需安装任何软件。

## 快速开始

### 访问编辑器
1. 在浏览器中打开 `mapeditor/index.html` 文件
2. 确保浏览器支持现代JavaScript功能
3. 建议使用最新版本的Chrome、Firefox或Safari

### 创建第一张地图
1. 点击右侧工具箱中的"**生成空白地图**"按钮
2. 系统会自动生成一个32x32的空白地图画布
3. 左侧显示地图编辑区域，右侧显示地形工具面板

## 界面布局

### 主要区域划分
- **左侧编辑区域 (50%)**：地图画布，显示32x32网格
- **中右侧工具面板 (35%)**：地形选择工具和坐标信息
- **右侧工具箱 (10%)**：主要功能按钮

### 工具面板说明
- **左侧地形栏**：基础地形（平原、草地、城池、村庄、森林、营寨）
- **中间地形栏**：山地地形（10种不同山地样式）  
- **右侧河流栏**：河流水系地形（30多种河流连接样式和智能河流工具）

## 主要功能

### 地形绘制
1. **选择地形**：点击右侧面板中的任意地形图标
2. **绘制模式**：
   - **单点模式**：左键点击地图单元格直接绘制
   - **画笔模式**：右键切换到画笔模式，可连续绘制
3. **模式切换**：右键点击地图区域在"画笔/刷子"模式间切换
4. **坐标显示**：鼠标悬停时显示当前坐标位置

### 智能河流系统
地图编辑器提供了智能河流绘制功能：
1. 选择工具面板最右下角的"智能河流"工具（显示为河流图标）
2. 在地图上绘制河流时，系统会自动判断周围地形
3. 根据上下左右相邻的河流位置，自动选择最合适的河流连接样式
4. 支持河流的弯道、直线、分叉等复杂形态的自动匹配

### 工具箱功能
- **生成空白地图**：创建新的32x32地图
- **重置地图**：清空当前地图，刷新页面
- **导出地图**：生成地图代码文件
- **显示/隐藏边框**：切换网格边框显示
- **更新编辑器**：显示版本信息（功能性按钮）

## 地形类型详解

### 基础地形
- **平原 (1)**：游戏中的基础地形，部队移动速度正常
- **草地 (2)**：略有阻碍的地形
- **城池 (3)**：重要的战略据点
- **村庄 (4)**：可以进行补给的地点
- **森林 (5)**：阻挡视线和移动的地形
- **营寨 (41)**：军事营地

### 山地系列 (6-15)
提供10种不同样式的山地地形，可以组合成复杂的山脉地形。山地通常是不可通行或难以通行的地形。

### 河流水系 (16-45, 除41)
- **直线河流**：横向和纵向的直线河段
- **弯曲河流**：各种角度的河流弯道
- **河流交汇**：多条河流的汇合点
- **河流源头**：河流的起始点
- **智能匹配**：系统自动选择合适的连接样式

## 导出功能

### 地图代码生成
1. 完成地图设计后，点击"**导出地图**"按钮
2. 系统会自动生成包含以下内容的文本文件：
   - 地图测试网址信息
   - 技术支持联系方式
   - 标准的地图代码格式
   - 32x32的地形数据数组

### 生成的代码格式
```javascript
// 地图测试网址：http://baye.bbkgames.com/designer.html
// 技术支持：半夏，交流QQ群：526266208

baye.drawMap(32, 32,[
  1, 1, 1, 2, 3, 4, 5, ...
  // 1024个数字，代表32x32地图的每个位置的地形类型
])
```

### 代码使用
- 生成的代码可以直接用于三国霸业游戏中
- 将代码复制到游戏的地图文件中即可加载自定义地图
- 数字对应不同的地形类型ID

## 操作技巧

### 高效绘制
1. **批量绘制**：使用右键切换到画笔模式，可以连续绘制大面积地形
2. **精确定位**：观察左下角的坐标显示，精确控制绘制位置
3. **边框辅助**：使用"显示/隐藏边框"功能帮助精确对齐

### 河流绘制建议
1. 先绘制主要河流走向的关键节点
2. 使用智能河流工具自动连接
3. 对不满意的连接点进行手动调整
4. 建议从上游向下游方向绘制

### 地形搭配
- **山脉**：使用多种山地地形组合成连续山脉
- **水系**：合理使用河流地形创建河流网络
- **据点**：在战略位置放置城池和村庄
- **阻挡**：用森林和山地控制战斗区域

## 注意事项

### 技术限制
- 地图固定为32x32格式
- 每个地形格子对应一个地形类型ID
- 支持的地形类型范围：1-45（除部分保留ID）

### 浏览器兼容性
- 建议使用现代浏览器
- 需要支持HTML5 Canvas和现代JavaScript
- 确保浏览器已启用JavaScript

### 文件保存
- 导出的地图文件为`.txt`格式
- 文件名默认为"自定义地图代码.txt"
- 保存位置取决于浏览器下载设置

## 技术支持

- **开发者**：半夏
- **QQ交流群**：526266208
- **在线测试**：http://baye.bbkgames.com/designer.html
- **最后更新**：2018-5-2

如有任何问题或建议，欢迎通过QQ群联系开发者进行交流。

## 版本历史

当前版本为网页版地图编辑器，提供完整的可视化地图编辑功能。编辑器会持续优化和改进，但如开发者所言："等编辑器用坏了再更新"。